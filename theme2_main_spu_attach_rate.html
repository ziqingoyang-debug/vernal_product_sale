# Retry creating the downloadable HTML file for Theme 2

from pathlib import Path

path = "/mnt/data/theme2_main_spu_attach_rate.html"

html = """<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8"/>
<title>分析主题二 · 主销品带出的搭售率（量的维度）</title>
<script src="https://cdn.jsdelivr.net/npm/echarts@5"></script>
<style>
body{margin:0;padding:24px;background:#f5f6f8;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial;color:#222}
h1{font-size:26px;margin:0 0 6px}
.subtitle{color:#555;margin-bottom:20px}
.panel{background:#fff;border-radius:12px;padding:16px 20px;margin-bottom:20px;box-shadow:0 2px 8px rgba(0,0,0,.06)}
.filters{display:grid;grid-template-columns:240px 220px 220px 260px;gap:16px}
.filter-item{display:flex;flex-direction:column;font-size:13px}
.filter-item label{margin-bottom:4px;color:#666}
.filter-item select,.filter-item input{padding:6px 10px;border-radius:6px;border:1px solid #ccc}
.chart-box{height:360px;background:#fff;border-radius:12px;padding:10px;box-shadow:0 2px 6px rgba(0,0,0,.06)}
.chart-desc{margin-top:8px;font-size:13px;color:#666;line-height:1.6}
.chart-row{display:flex;gap:16px}
.side-filter{width:220px}
</style>
</head>
<body>

<h1>分析主题二：主销品带出的搭售率（量的维度）</h1>
<div class="subtitle">目标：对比主销品不同搭售件的实际 / 预计搭售率差距，用于判断搭售结构是否合理并调整预期</div>

<div class="panel">
  <div class="filters">
    <div class="filter-item"><label>销售时间</label><input value="2025-11-01 ~ 2025-11-30"/></div>
    <div class="filter-item"><label>场景</label><select multiple><option>基础场景</option><option>行政场景</option><option>H 场景</option><option>S 场景</option></select></div>
    <div class="filter-item"><label>国家</label><select multiple><option>US</option><option>DE</option><option>UK</option></select></div>
    <div class="filter-item"><label>主销品 YSPU（仅支持主销品）</label>
      <select><option>v0.7整桌</option><option>柜子</option><option>实木贴皮</option><option>H风格套系</option><option>W风格套系</option><option>v0.7Home</option><option>夹式排插</option><option>电子类独立配件</option><option>0.7Edge</option></select>
    </div>
  </div>
</div>

<div class="panel">
  <h3>不同搭售件的搭售率对比（实际 vs 预计）</h3>
  <div class="chart-box" id="attachRateByItem"></div>
  <div class="chart-desc">本图回答的问题：该主销品对哪些搭售件“带得动”，哪些明显低于预期？</div>
</div>

<div class="panel">
  <h3>指定搭售件的月度搭售率趋势</h3>
  <div class="chart-row">
    <div class="side-filter">
      <div class="filter-item">
        <label>搭售件（单选）</label>
        <select id="attachItemSelect">
          <option value="小高台">小高台</option>
          <option value="下抽屉">下抽屉</option>
          <option value="洞洞板">洞洞板</option>
        </select>
      </div>
    </div>
    <div class="chart-box" id="attachRateTrend"></div>
  </div>
  <div class="chart-desc">本图回答的问题：该搭售件的搭售能力是持续改善，还是近期出现下滑？</div>
</div>

<script>
const attachItems=["小高台","下抽屉","洞洞板"];
const actualRate=[18,12,9];
const expectedRate=[22,15,12];

const chart1=echarts.init(document.getElementById("attachRateByItem"));
chart1.setOption({
  tooltip:{trigger:"axis"},
  legend:{data:["实际搭售率","预计搭售率"]},
  xAxis:{type:"category",data:attachItems},
  yAxis:{type:"value",axisLabel:{formatter:"{value}%"}},
  series:[
    {name:"实际搭售率",type:"line",data:actualRate},
    {name:"预计搭售率",type:"line",data:expectedRate,lineStyle:{type:"dashed"}}
  ]
});

const months=["7月","8月","9月","10月","11月"];
const trendData={
  "小高台":{actual:[12,14,15,17,18],expected:[14,15,16,17,18]},
  "下抽屉":{actual:[8,9,10,11,12],expected:[10,11,12,13,14]},
  "洞洞板":{actual:[6,7,8,8,9],expected:[8,9,9,10,11]}
};

const chart2=echarts.init(document.getElementById("attachRateTrend"));
function renderTrend(item){
  chart2.clear();
  chart2.setOption({
    tooltip:{trigger:"axis"},
    legend:{data:["实际搭售率","预计搭售率"]},
    xAxis:{type:"category",data:months},
    yAxis:{type:"value",axisLabel:{formatter:"{value}%"}},
    series:[
      {name:"实际搭售率",type:"line",data:trendData[item].actual},
      {name:"预计搭售率",type:"line",data:trendData[item].expected,lineStyle:{type:"dashed"}}
    ]
  });
}
renderTrend("小高台");
document.getElementById("attachItemSelect").addEventListener("change",e=>renderTrend(e.target.value));
window.addEventListener("resize",()=>{chart1.resize();chart2.resize();});
</script>

</body>
</html>
"""

Path(path).write_text(html, encoding="utf-8")

path
