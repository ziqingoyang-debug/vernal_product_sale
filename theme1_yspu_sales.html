from pathlib import Path

html = """<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8"/>
<title>分析主题一 · YSPU 销售表现（完整终版）</title>
<script src="https://cdn.jsdelivr.net/npm/echarts@5"></script>
<style>
body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Arial;background:#f5f6f8;margin:0;padding:24px;color:#222}
h1{font-size:26px;margin-bottom:6px}
.subtitle{color:#555;margin-bottom:20px}
.panel{background:#fff;border-radius:12px;padding:16px 20px;margin-bottom:20px;box-shadow:0 2px 8px rgba(0,0,0,.06)}
.filters{display:grid;grid-template-columns:220px 220px 220px 180px 220px 260px;gap:16px}
.filter-item{display:flex;flex-direction:column;font-size:13px}
.filter-item label{margin-bottom:4px;color:#666}
.filter-item select,.filter-item input{padding:6px 10px;border-radius:6px;border:1px solid #ccc}
.kpi-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:16px}
.kpi-card{background:#fff;border-radius:12px;padding:14px 16px;box-shadow:0 2px 6px rgba(0,0,0,.06)}
.kpi-title{font-size:14px;color:#555;margin-bottom:6px}
.kpi-main{font-size:22px;font-weight:bold}
.kpi-sub{font-size:12px;color:#777;margin-top:4px}
.tabs{display:flex;gap:12px;margin-bottom:12px}
.tab{padding:8px 16px;border-radius:6px;background:#eee;cursor:pointer;font-size:14px}
.tab.active{background:#2a5cff;color:#fff}
.chart-row{display:flex;gap:16px}
.chart-box{flex:1;height:340px;background:#fff;border-radius:12px;padding:10px;box-shadow:0 2px 6px rgba(0,0,0,.06)}
.metric-row{display:flex;gap:16px;margin-top:16px}
.hidden{display:none}
</style>
</head>
<body>

<h1>分析主题一：YSPU 销售表现</h1>
<div class="subtitle">
目标：识别主销品和搭售件的销售趋势，对销量偏差做初步拆解（搭售件：单独销售 or 搭售销量不达预期）
</div>

<div class="panel">
<div class="filters">
<div class="filter-item"><label>销售时间</label><input value="2025-11-01 ~ 2025-11-30"/></div>

<div class="filter-item">
<label>场景</label>
<select multiple>
<option>基础场景</option><option>行政场景</option><option>H 场景</option><option>S 场景</option>
</select>
</div>

<div class="filter-item">
<label>国家</label>
<select multiple>
<option>US</option><option>DE</option><option>UK</option>
</select>
</div>

<div class="filter-item">
<label>类型</label>
<select id="typeSelect" onchange="onTypeChange()">
<option value="main">主销品</option>
<option value="attach">搭售件</option>
</select>
</div>

<div class="filter-item">
<label>YSPU</label>
<select id="yspuSelect"></select>
</div>

<div class="filter-item">
<label>YSKU</label>
<select>
<option>小高台 | 标准 | 黑色</option>
<option>小高台 | 加宽 | 白色</option>
</select>
</div>
</div>
</div>

<div class="kpi-grid">
<div class="kpi-card"><div class="kpi-title">销量</div><div class="kpi-main">1,280</div><div class="kpi-sub">预计 1,400 ｜ 偏差 -120</div></div>
<div class="kpi-card"><div class="kpi-title">单独销量</div><div class="kpi-main">860</div><div class="kpi-sub">预计 950 ｜ 偏差 -90</div></div>
<div class="kpi-card"><div class="kpi-title">搭售销量</div><div class="kpi-main">420</div><div class="kpi-sub">预计 450 ｜ 偏差 -30</div></div>
<div class="kpi-card"><div class="kpi-title">销售额</div><div class="kpi-main">$512,000</div></div>
<div class="kpi-card"><div class="kpi-title">件单价（实际）</div><div class="kpi-main">$400</div></div>
<div class="kpi-card"><div class="kpi-title">运营利润额</div><div class="kpi-main">$138,000</div></div>
<div class="kpi-card"><div class="kpi-title">运营利润率</div><div class="kpi-main">27%</div></div>
<div class="kpi-card"><div class="kpi-title">推广费占比</div><div class="kpi-main">18%</div><div class="kpi-sub">YSKU 维度不适用</div></div>
</div>

<div class="panel">
<div class="tabs">
<div class="tab active" id="tabInd" onclick="showInd()">独立销量</div>
<div class="tab" id="tabAtt" onclick="showAtt()">搭售销量</div>
</div>

<div id="indBlock">
<div class="chart-row">
<div class="chart-box" id="indTrend"></div>
</div>
<div class="metric-row">
<div class="kpi-card"><div class="kpi-title">流量</div><div class="kpi-main">24,000</div><div class="kpi-sub">预计 26,000 ｜ 偏差 -2,000</div></div>
<div class="kpi-card"><div class="kpi-title">订单转化率</div><div class="kpi-main">3.6%</div><div class="kpi-sub">预计 3.9% ｜ 偏差 -0.3pp</div></div>
<div class="kpi-card"><div class="kpi-title">平均购买件数</div><div class="kpi-main">1.12</div><div class="kpi-sub">预计 1.18 ｜ 偏差 -0.06</div></div>
</div>
</div>

<div id="attBlock" class="hidden">
<div class="chart-row">
<div class="chart-box" id="attCompare"></div>
<div class="chart-box" id="attDev"></div>
</div>
</div>
</div>

<script>
const mainSPUList=["v0.7整桌","柜子","实木贴皮","H风格套系","W风格套系","v0.7Home","夹式排插","电子类独立配件","0.7Edge"];
const attachSPUList=["小高台","下抽屉","柜子"];

let indChart, attCompareChart, attDevChart;

function onTypeChange(){
  const type=typeSelect.value;
  yspuSelect.innerHTML="";
  (type==="main"?mainSPUList:attachSPUList).forEach(v=>{
    const o=document.createElement("option");o.text=v;yspuSelect.add(o);
  });
  if(type==="main"){
    tabAtt.classList.add("hidden");
    showInd();
  }else{
    tabAtt.classList.remove("hidden");
    showAtt();
  }
}

function showInd(){
  indBlock.style.display="block";
  attBlock.style.display="none";
  tabInd.classList.add("active");
  tabAtt.classList.remove("active");
  indChart.resize();
}

function showAtt(){
  indBlock.style.display="none";
  attBlock.style.display="block";
  tabInd.classList.remove("active");
  tabAtt.classList.add("active");
  attCompareChart.resize();
  attDevChart.resize();
}

indChart=echarts.init(document.getElementById("indTrend"));
indChart.setOption({
title:{text:"独立销量月度趋势"},
xAxis:{type:"category",data:["7月","8月","9月","10月","11月"]},
yAxis:{type:"value"},
series:[{type:"line",data:[720,760,810,830,860]}]
});

const expected=[180,120,90,160,110,140,100,80,60];
const actual=[150,95,70,130,85,120,90,60,40];
const deviation=actual.map((v,i)=>v-expected[i]);

attCompareChart=echarts.init(document.getElementById("attCompare"));
attCompareChart.setOption({
title:{text:"搭售件在不同主销品下的搭售量（预计 vs 实际）"},
legend:{data:["预计","实际"]},
xAxis:{type:"category",data:mainSPUList},
yAxis:{type:"value"},
series:[
{name:"预计",type:"bar",data:expected,itemStyle:{color:"#cfd8ff"}},
{name:"实际",type:"bar",data:actual,itemStyle:{color:"#2a5cff"}}
]
});

attDevChart=echarts.init(document.getElementById("attDev"));
attDevChart.setOption({
title:{text:"搭售偏差（实际 - 预计）"},
xAxis:{type:"category",data:mainSPUList},
yAxis:{type:"value"},
series:[{type:"bar",data:deviation,
itemStyle:{color:p=>p.value>=0?"#4caf50":"#e53935"}}]
});

onTypeChange();
</script>

</body>
</html>
"""

path="/mnt/data/theme1_yspu_sales_complete.html"
Path(path).write_text(html, encoding="utf-8")
path
